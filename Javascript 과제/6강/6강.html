<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="6ê°•.css">
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
    </ul>
  </form>
<script>
const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

let cities = [] //constì˜ ê²½ìš° ë³€í•˜ì§€ì•Šìœ¼ë¯€ë¡œ const ì—ì„œ letìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. 

fetch(endpoint)
    .then(blob => blob.json()) //json ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³ 
    .then(data => cities.push(...data)) //ë°”ë€ ë°ì´í„°ë¥¼ citiesë¼ëŠ” ë¦¬ìŠ¤íŠ¸ì— ì§‘ì–´ë„£ëŠ”ë‹¤.
//ìœ„ì˜ fetchëŠ” ê°€ì ¸ì˜¤ê¸° ë¼ëŠ” ëœ»ìœ¼ë¡œ apië¥¼ ê°€ì ¸ì˜¤ëŠ” ì—­í• ì„í•œë‹¤.


function findMatches(wordToMatch, cities){
  return cities.filter(place => {
    //return place.city.match(/wordToMatch/i) // í•´ë‹¹êµ¬ë¬¸ì€ ë§ì€ ì •ë³´ì¤‘ì—ì„œ ë‚´ê°€ input ì¹¸ì— ì…ë ¥í•œ ë‹¨ì–´ë¥¼ ì°¾ê²Œí•˜ëŠ” êµ¬ë¬¸
    const regex = new RegExp(wordToMatch, 'gi');
    return place.city.match(regex) || place.state.match(regex)
    //regExp ìƒì„±ìëŠ” íŒ¨í„´ì„ ì‚¬ìš©í•´ í…ìŠ¤íŠ¸ë¥¼ íŒë³„í•  ë•Œ ì‚¬ìš©í•œë‹¤. 
    //new RegExp(/ab+c/, 'i') ë¦¬í„°ëŸ´ -> ë§¤ê°œë³€ìˆ˜ëŠ” ë‘ ë¹—ê¸ˆìœ¼ë¡œ ê°ì‹¸ì•¼ í•˜ë©° ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    //new RegExp('ab+c','i') ìƒì„±ì ->ë§¤ê°œë³€ìˆ˜ëŠ” ë¹—ê¸ˆìœ¼ë¡œ ê°ì‹¸ì§€ ì•Šìœ¼ë‚˜ ë”°ì˜´í‘œë¥¼ ì‚¬ìš©í•œë‹¤.
  });
}

function numberwithCommas(x){
  return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}//ì¸êµ¬ìˆ˜ ì‰¼í‘œë¥¼ ë„£ì–´ì£¼ëŠ”ê²ƒ. 3ê°œ ë‚˜ì˜¬ë•Œë§ˆë‹¤ ,ë¥¼ ë„£ì–´ì¤€ë‹¤.

function displayMatches(){
  const matchArray = findMatches(this.value, cities);
  //console.log(matchArray);

  const html = matchArray.map(place => {
    const regex = new RegExp(this.value, 'gi')
    const cityName = place.city.replace(regex, `<span class="h1">${this.value}</span>`);
    const stateName = place.state.replace(regex, `<span class="h1">${this.value}</span>`);
    return `
      <li>
        <span class="name">${cityName}, ${stateName.state}</span> <!--ë„ì‹œì™€ ì£¼ë¥¼ ë‚˜íƒ€ë‚´ì£¼ëŠ” span-->
        <span class="name">${numberwithCommas(place.population)}</span> <!--ì¸êµ¬ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ì£¼ëŠ” span-->
      </li>
    `;
  }).join(''); // joinì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì—¬ëŸ¬ë°°ì—´ì´ ìˆëŠ” ë°°ì—´ë¡œ ë°”ë€ë‹¤.
  suggestions.innerHTML = html;
}

const searchInput = document.querySelector('.search');
const suggestions = document.querySelector('.suggestions');

searchInput.addEventListener('change', displayMatches);
searchInput.addEventListener('keyup', displayMatches);

</script>
</body>
</html>
